import kfold_module
import pandas as pd
from sklearn.ensemble import RandomForestClassifier




dataset = pd.read_csv('dataset.csv')

target = dataset.iloc[:,30].values
data = dataset.iloc[:,0:30].values
print(dataset)

##  n_estimators is how many trees you want
machine = RandomForestClassifier(criterion = 'gini',max_depth=80,n_estimators = 11)
r2, confusion_matrix, accu_rate = kfold_module.run_kfold(3,data,target,machine,1,1)
print(r2, accu_rate)
for i in confusion_matrix:
    print(i)
"""
max_depth = 10
[0.46192516679634466, 0.29807457576553265, 0.32024241605382997] [0.8285508572457138, 0.8000059999700001, 0.8062730627306273]
[[    1   909    11     1]
 [    0 44846   857     4]
 [    0  6926  6631   171]
 [    1  1585   965  3759]]
[[    6   935    18     0]
 [    0 45208   586     5]
 [    0  8324  5234   182]
 [    0  2531   752  2886]]
[[   17   911     5     0]
 [    1 45070   712     1]
 [    1  7938  5639   163]
 [    0  2477   706  3025]]
"""

"""
max_depth = 30
[0.7708396053837197, 0.7819501016024198, 0.781090489855996] [0.8986455067724661, 0.9039104804475978, 0.9032340323403234]
[[  265   643    13     1]
 [   42 44084  1573     8]
 [    1  3223 10180   324]
 [    2    24   903  5381]]
[[  309   636    14     0]
 [   39 44351  1401     8]
 [    2  3151 10226   361]
 [    1    12   781  5375]]
[[  343   583     7     0]
 [   67 44299  1416     2]
 [    2  3218 10161   360]
 [    0    25   771  5412]]
"""
"""
max_depth = 80
[0.7775961772151578, 0.7817829367002445, 0.7815577460142543] [0.9010454947725262, 0.9039704801475993, 0.9040740407404074]
[[  288   625     8     1]
 [   35 44141  1527     4]
 [    1  3206 10201   320]
 [    1    21   848  5440]]
[[  352   598     8     1]
 [   33 44339  1414    13]
 [    1  3199 10202   338]
 [    0    17   780  5372]]
[[  371   557     5     0]
 [   71 44296  1415     2]
 [    3  3193 10226   319]
 [    3    32   795  5378]]
"""